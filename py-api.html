<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Python API reference &#8212; galario 0.1 documentation</title>
    <link rel="stylesheet" href="_static/pydoctheme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Using galario from C" href="C-api.html" />
    <link rel="prev" title="A quickstart example" href="quickstart.html" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <link rel="shortcut icon" type="image/png" href="_static/favicon.png" />
    <meta name="viewport" content="width=device-width,initial-scale=0.8">
    
    

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="responsive-menu"><a href="#sidebar-anchor" title="Navigation">&#9776;</a></li>
        <li><a href="index.html">galario 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    
        <div class="badge">
            <a href="https://github.com/mtazzari/galario/">Fork me on GitHub</a>
            <img src="_static/right-red@2x.png">
        </div>
    
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="python-api-reference">
<h1>Python API reference<a class="headerlink" href="#python-api-reference" title="Permalink to this headline">¶</a></h1>
<div class="section" id="computing-synthetic-visibilities">
<h2>Computing synthetic visibilities<a class="headerlink" href="#computing-synthetic-visibilities" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#galario.double.sampleImage" title="galario.double.sampleImage"><code class="xref py py-func docutils literal"><span class="pre">sampleImage()</span></code></a> and <a class="reference internal" href="#galario.double.sampleProfile" title="galario.double.sampleProfile"><code class="xref py py-func docutils literal"><span class="pre">sampleProfile()</span></code></a> functions
allow to compute synthetic visibilities.</p>
<dl class="function">
<dt id="galario.double.sampleImage">
<code class="descclassname">galario.double.</code><code class="descname">sampleImage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#galario.double.sampleImage" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the synthetic visibilities of a model image at the specified (u, v) locations.</p>
<p>The 2D surface brightness in <cite>image</cite> is Fourier transformed and sampled in the
(u, v) locations given in the <cite>u</cite> and <cite>v</cite> arrays.</p>
<p>Typical call signature:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">vis</span> <span class="o">=</span> <span class="n">sampleImage</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">dxy</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">dRA</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dDec</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">PA</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">uvcheck</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>image</strong> (<em>2D array_like</em><em>, </em><em>float</em>) – Square matrix of shape (nxy, nxy) containing the 2D surface brightness of the model.
Assume the x-axis (R.A.) increases from right (West) to left (East)
and the y-axis (Dec.) increases from bottom (South) to top (North).
<cite>nxy</cite> must be even.
<strong>units</strong>: Jy/pixel</li>
<li><strong>u</strong> (<em>array_like</em><em>, </em><em>float</em>) – u coordinate of the visibility points where the FT has to be sampled.
<strong>units</strong>: wavelength</li>
<li><strong>v</strong> (<em>array_like</em><em>, </em><em>float</em>) – v coordinate of the visibility points where the FT has to be sampled.
The length of v must be equal to the length of u.
<strong>units</strong>: wavelength</li>
<li><strong>dxy</strong> (<em>float</em>) – Size of the image cell, assumed equal and uniform in both x and y direction.
<strong>units</strong>: cm</li>
<li><strong>dist</strong> (<em>float</em>) – Distance to the source.
<strong>units</strong>: cm</li>
<li><strong>dRA</strong> (<em>float</em><em>, </em><em>optional</em>) – R.A. offset w.r.t. the phase center by which the image is translated.
If dRA &gt; 0 translate the image towards the left (East). Default is 0.
<strong>units</strong>: arcsecond</li>
<li><strong>dDec</strong> (<em>float</em><em>, </em><em>optional</em>) – Dec. offset w.r.t. the phase center by which the image is translated.
If dDec &gt; 0 translate the image towards the top (North). Default is 0.
<strong>units</strong>: arcsecond</li>
<li><strong>PA</strong> (<em>float</em><em>, </em><em>optional</em>) – Position Angle, defined East of North. Default is 0.
<strong>units</strong>: degree</li>
<li><strong>uvcheck</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, check whether <cite>image</cite> and <cite>dxy</cite> satisfy Nyquist criterion for computing
the synthetic visibilities in the (u, v) locations provided.
Default is False since the check might take time. For executions where speed is important, set to False.</li>
<li><strong>maxuv_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – See <a class="reference internal" href="#galario.double.check_uvplane" title="galario.double.check_uvplane"><code class="xref py py-func docutils literal"><span class="pre">check_uvplane()</span></code></a>.
<strong>units</strong>: pure number</li>
<li><strong>minuv_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – See <a class="reference internal" href="#galario.double.check_uvplane" title="galario.double.check_uvplane"><code class="xref py py-func docutils literal"><span class="pre">check_uvplane()</span></code></a>.
<strong>units</strong>: pure number</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>vis</strong> – Synthetic visibilities sampled in the (u, v) locations given in <cite>u</cite> and <cite>v</cite>.
<strong>units</strong>: Jy</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like, complex</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="galario.double.sampleProfile">
<code class="descclassname">galario.double.</code><code class="descname">sampleProfile</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#galario.double.sampleProfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the synthetic visibilities of a model with an axisymmetric brightness profile.</p>
<p>The brightness profile <cite>intensity</cite> is used to build a 2D image of the model, which is
then Fourier transformed and sampled in the (u, v) locations given in the <cite>u</cite> and <cite>v</cite> arrays.</p>
<p>The image is created as in <a class="reference internal" href="#galario.double.sweep" title="galario.double.sweep"><code class="xref py py-func docutils literal"><span class="pre">sweep()</span></code></a> assuming that the x-axis (R.A.) increases
from right (West) to left (East) and the y-axis (Dec.) increases from bottom (South) to top (North).</p>
<p>Typical call signature:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">vis</span> <span class="o">=</span> <span class="n">sampleProfile</span><span class="p">(</span><span class="n">intensity</span><span class="p">,</span> <span class="n">Rmin</span><span class="p">,</span> <span class="n">dR</span><span class="p">,</span> <span class="n">nxy</span><span class="p">,</span> <span class="n">dxy</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span>
                    <span class="n">dRA</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dDec</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">PA</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">uvcheck</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>intensity</strong> (<em>(</em><em>M</em><em>,</em><em>) </em><em>array_like</em><em>, </em><em>float</em>) – Array containing the radial brightness profile of the model.
The profile is assumed to be sampled on a linear radial grid starting
at <cite>Rmin</cite> with spacing <cite>dR</cite>.
<strong>units</strong>: Jy/sr</li>
<li><strong>Rmin</strong> (<em>float</em>) – Inner edge of the radial grid, i.e. the radius where the brightness is intensity[0].
<strong>units</strong>: cm</li>
<li><strong>dR</strong> (<em>float</em>) – Size of the cell of the radial grid, assumed linear.
<strong>units</strong>: cm</li>
<li><strong>nxy</strong> (<em>int</em>) – Side of the square model image, which is internally computed.
<strong>units</strong>: pixel</li>
<li><strong>dxy</strong> (<em>float</em>) – Size of the image cell, assumed equal and uniform in both x and y direction.
<strong>units</strong>: cm</li>
<li><strong>dist</strong> (<em>float</em>) – Distance to the source.
<strong>units</strong>: cm</li>
<li><strong>u</strong> (<em>array_like</em><em>, </em><em>float</em>) – u coordinate of the visibility points where the FT has to be sampled.
<strong>units</strong>: wavelength</li>
<li><strong>v</strong> (<em>array_like</em><em>, </em><em>float</em>) – v coordinate of the visibility points where the FT has to be sampled.
The length of v must be equal to the length of u.
<strong>units</strong>: wavelength</li>
<li><strong>dRA</strong> (<em>float</em><em>, </em><em>optional</em>) – R.A. offset w.r.t. the phase center by which the image is translated.
If dRA &gt; 0 translate the image towards the left (East). Default is 0.
<strong>units</strong>: arcsecond</li>
<li><strong>dDec</strong> (<em>float</em><em>, </em><em>optional</em>) – Dec. offset w.r.t. the phase center by which the image is translated.
If dDec &gt; 0 translate the image towards the top (North). Default is 0.
<strong>units</strong>: arcsecond</li>
<li><strong>inc</strong> (<em>float</em><em>, </em><em>optional</em>) – Inclination of the image plane along a North-South (top-bottom) axis.
If inc=0. the image is face-on; if inc=90. the image is edge-on.
<strong>units</strong>: degree</li>
<li><strong>PA</strong> (<em>float</em><em>, </em><em>optional</em>) – Position Angle, defined East of North. Default is 0.
<strong>units</strong>: degree</li>
<li><strong>uvcheck</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, check whether <cite>image</cite> and <cite>dxy</cite> satisfy Nyquist criterion for computing
the synthetic visibilities in the (u, v) locations provided.
Default is False since the check might take time. For executions where speed is important, set to False.</li>
<li><strong>maxuv_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – See <a class="reference internal" href="#galario.double.check_uvplane" title="galario.double.check_uvplane"><code class="xref py py-func docutils literal"><span class="pre">check_uvplane()</span></code></a>.
<strong>units</strong>: pure number</li>
<li><strong>minuv_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – See <a class="reference internal" href="#galario.double.check_uvplane" title="galario.double.check_uvplane"><code class="xref py py-func docutils literal"><span class="pre">check_uvplane()</span></code></a>.
<strong>units</strong>: pure number</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>vis</strong> – Synthetic visibilities sampled in the (u, v) locations given in <cite>u</cite> and <cite>v</cite>.
<strong>units</strong>: Jy</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like, complex</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#galario.double.sweep" title="galario.double.sweep"><code class="xref py py-func docutils literal"><span class="pre">sweep()</span></code></a></p>
</div>
</dd></dl>

<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The translation by (dRA, dDec) and the rotation by PA of the model image are optimized for speed: they are not obtained
with extra interpolations of the model image, but rather applied in the Fourier plane.</p>
<p>The offset is achieved by applying a complex phase to the sampled visibilities.
To rotation is achieved by internally rotating the (u, v) locations by -PA.</p>
<p class="last"><strong>Suggestion</strong> We recommend starting with <cite>uvcheck</cite> set to True to ensure the results obtained are correct.
Once a combination of matrix size and <cite>dxy</cite> for the given data has been found, <cite>uvcheck</cite>
can be safely set to False.</p>
</div>
</div>
<div class="section" id="computing-directly-the-chi-square">
<h2>Computing directly the chi square<a class="headerlink" href="#computing-directly-the-chi-square" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#galario.double.chi2Image" title="galario.double.chi2Image"><code class="xref py py-func docutils literal"><span class="pre">chi2Image()</span></code></a> and <a class="reference internal" href="#galario.double.chi2Profile" title="galario.double.chi2Profile"><code class="xref py py-func docutils literal"><span class="pre">chi2Profile()</span></code></a> functions
allow to compute directly the chi square.</p>
<dl class="function">
<dt id="galario.double.chi2Image">
<code class="descclassname">galario.double.</code><code class="descname">chi2Image</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#galario.double.chi2Image" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the chi square of a model image given the observed visibilities.</p>
<p>The chi square is computed from the observed and synthetic visibilities as:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chi2</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">w</span> <span class="o">*</span> <span class="p">((</span><span class="n">vis_obs_re</span><span class="o">-</span><span class="n">vis_re</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">vis_obs_im</span><span class="o">-</span><span class="n">vis_im</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p>where vis_re, vis_im are the real and imaginary part of the synthetic visibilities
that are computed internally.
The synthetic visibilities as in <a class="reference internal" href="#galario.double.sampleImage" title="galario.double.sampleImage"><code class="xref py py-func docutils literal"><span class="pre">sampleImage</span></code></a>.</p>
<p>Typical call signature:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chi2</span> <span class="o">=</span> <span class="n">chi2Image</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">dxy</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vis_obs_re</span><span class="p">,</span> <span class="n">vis_obs_im</span><span class="p">,</span> <span class="n">vis_obs_w</span><span class="p">,</span>
                 <span class="n">dRA</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dDec</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">PA</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">uvcheck</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>image</strong> (<em>2D array_like</em><em>, </em><em>float</em>) – Square matrix of shape (nxy, nxy) containing the 2D surface brightness of the model.
Assume the x-axis (R.A.) increases from right (West) to left (East)
and the y-axis (Dec.) increases from bottom (South) to top (North).
<cite>nxy</cite> must be even.
<strong>units</strong>: Jy/pixel</li>
<li><strong>dxy</strong> (<em>float</em>) – Size of the image cell, assumed equal and uniform in both x and y direction.
<strong>units</strong>: cm</li>
<li><strong>dist</strong> (<em>float</em>) – Distance to the source.
<strong>units</strong>: cm</li>
<li><strong>u</strong> (<em>array_like</em><em>, </em><em>float</em>) – u coordinate of the visibility points where the FT has to be sampled.
<strong>units</strong>: wavelength</li>
<li><strong>v</strong> (<em>array_like</em><em>, </em><em>float</em>) – v coordinate of the visibility points where the FT has to be sampled.
The length of <cite>v</cite> must be equal to the length of <cite>u</cite>.
<strong>units</strong>: wavelength</li>
<li><strong>vis_obs_re</strong> (<em>array_like</em><em>, </em><em>float</em>) – Real part of the observed visibilities.
<strong>units</strong>: Jy</li>
<li><strong>vis_obs_im</strong> (<em>array_like</em><em>, </em><em>float</em>) – Imaginary part of the observed visibilities.
The length of <cite>vis_obs_im</cite> must be equal to the length of <cite>vis_obs_re</cite>.
<strong>units</strong>: Jy</li>
<li><strong>vis_obs_w</strong> (<em>array_like</em><em>, </em><em>float</em>) – Weight associated to the observed visibilities.
The length of <cite>vis_obs_w</cite> must be equal to the length of <cite>vis_obs_re</cite>.
<strong>units</strong>:</li>
<li><strong>dRA</strong> (<em>float</em><em>, </em><em>optional</em>) – R.A. offset w.r.t. the phase center by which the image is translated.
If dRA &gt; 0 translate the image towards the left (East). Default is 0.
<strong>units</strong>: arcsecond</li>
<li><strong>dDec</strong> (<em>float</em><em>, </em><em>optional</em>) – Dec. offset w.r.t. the phase center by which the image is translated.
If dDec &gt; 0 translate the image towards the top (North). Default is 0.
<strong>units</strong>: arcsecond</li>
<li><strong>PA</strong> (<em>float</em><em>, </em><em>optional</em>) – Position Angle, defined East of North. Default is 0.
<strong>units</strong>: degree</li>
<li><strong>uvcheck</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, check whether <cite>image</cite> and <cite>dxy</cite> satisfy Nyquist criterion for computing
the synthetic visibilities in the (u, v) locations provided.
Default is False since the check might take time. For executions where speed is important, set to False.</li>
<li><strong>maxuv_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – See <a class="reference internal" href="#galario.double.check_uvplane" title="galario.double.check_uvplane"><code class="xref py py-func docutils literal"><span class="pre">check_uvplane()</span></code></a>.
<strong>units</strong>: pure number</li>
<li><strong>minuv_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – See <a class="reference internal" href="#galario.double.check_uvplane" title="galario.double.check_uvplane"><code class="xref py py-func docutils literal"><span class="pre">check_uvplane()</span></code></a>.
<strong>units</strong>: pure number</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>chi2</strong> – The chi square, not normalized.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#galario.double.sampleImage" title="galario.double.sampleImage"><code class="xref py py-func docutils literal"><span class="pre">sampleImage()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="galario.double.chi2Profile">
<code class="descclassname">galario.double.</code><code class="descname">chi2Profile</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#galario.double.chi2Profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the chi square of a model with an axisymmetric brightness profile
given the observed visibilities.</p>
<p>The image is created from the intensity profile as in <a class="reference internal" href="#galario.double.sweep" title="galario.double.sweep"><code class="xref py py-func docutils literal"><span class="pre">sweep</span></code></a>.
The synthetic visibilities are computed as in <a class="reference internal" href="#galario.double.sampleProfile" title="galario.double.sampleProfile"><code class="xref py py-func docutils literal"><span class="pre">sampleProfile</span></code></a>.
The chi square is computed from the observed and synthetic visibilities as:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chi2</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">w</span> <span class="o">*</span> <span class="p">((</span><span class="n">vis_obs_re</span><span class="o">-</span><span class="n">vis_re</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">vis_obs_im</span><span class="o">-</span><span class="n">vis_im</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p>where vis_re, vis_im are the real and imaginary part of the synthetic visibilities
that are computed internally.</p>
<p>Typical call signature:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chi2</span> <span class="o">=</span> <span class="n">chi2Profile</span><span class="p">(</span><span class="n">intensity</span><span class="p">,</span> <span class="n">Rmin</span><span class="p">,</span> <span class="n">dR</span><span class="p">,</span> <span class="n">nxy</span><span class="p">,</span> <span class="n">dxy</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vis_obs_re</span><span class="p">,</span> <span class="n">vis_obs_im</span><span class="p">,</span> <span class="n">vis_obs_w</span><span class="p">,</span>
                   <span class="n">dRA</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dDec</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">PA</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">uvcheck</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>intensity</strong> (<em>array_like</em><em>, </em><em>float</em>) – Array containing the radial brightness profile of the model.
The profile is assumed to be sampled on a linear radial grid starting
at <cite>Rmin</cite> with spacing <cite>dR</cite>.
<strong>units</strong>: Jy/sr</li>
<li><strong>Rmin</strong> (<em>float</em>) – Inner edge of the radial grid, i.e. the radius where the brightness is <cite>intensity[0]</cite>.
<strong>units</strong>: cm</li>
<li><strong>dR</strong> (<em>float</em>) – Size of the cell of the radial grid, assumed linear.
<strong>units</strong>: cm</li>
<li><strong>nxy</strong> (<em>int</em>) – Side of the square model image, which is internally computed.
<strong>units</strong>: pixel</li>
<li><strong>dxy</strong> (<em>float</em>) – Size of the image cell, assumed equal and uniform in both x and y direction.
<strong>units</strong>: cm</li>
<li><strong>dist</strong> (<em>float</em>) – Distance to the source.
<strong>units</strong>: cm</li>
<li><strong>u</strong> (<em>array_like</em><em>, </em><em>float</em>) – u coordinate of the visibility points where the FT has to be sampled.
<strong>units</strong>: wavelength</li>
<li><strong>v</strong> (<em>array_like</em><em>, </em><em>float</em>) – v coordinate of the visibility points where the FT has to be sampled.
The length of <cite>v</cite> must be equal to the length of <cite>u</cite>.
<strong>units</strong>: wavelength</li>
<li><strong>vis_obs_re</strong> (<em>array_like</em><em>, </em><em>float</em>) – Real part of the observed visibilities.
<strong>units</strong>: Jy</li>
<li><strong>vis_obs_im</strong> (<em>array_like</em><em>, </em><em>float</em>) – Imaginary part of the observed visibilities.
The length of <cite>vis_obs_im</cite> must be equal to the length of <cite>vis_obs_re</cite>.
<strong>units</strong>: Jy</li>
<li><strong>vis_obs_w</strong> (<em>array_like</em><em>, </em><em>float</em>) – Weight associated to the observed visibilities.
The length of <cite>vis_obs_w</cite> must be equal to the length of <cite>vis_obs_re</cite>.
<strong>units</strong>:</li>
<li><strong>dRA</strong> (<em>float</em><em>, </em><em>optional</em>) – R.A. offset w.r.t. the phase center by which the image is translated.
If dRA &gt; 0 translate the image towards the left (East). Default is 0.
<strong>units</strong>: arcsecond</li>
<li><strong>dDec</strong> (<em>float</em><em>, </em><em>optional</em>) – Dec. offset w.r.t. the phase center by which the image is translated.
If dDec &gt; 0 translate the image towards the top (North). Default is 0.
<strong>units</strong>: arcsecond</li>
<li><strong>inc</strong> (<em>float</em><em>, </em><em>optional</em>) – Inclination of the image plane along a North-South (top-bottom) axis.
If inc=0. the image is face-on; if inc=90. the image is edge-on.
<strong>units</strong>: degree</li>
<li><strong>PA</strong> (<em>float</em><em>, </em><em>optional</em>) – Position Angle, defined East of North. Default is 0.
<strong>units</strong>: degree</li>
<li><strong>uvcheck</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, check whether <cite>image</cite> and <cite>dxy</cite> satisfy Nyquist criterion for computing
the synthetic visibilities in the (u, v) locations provided.
Default is False since the check might take time. For executions where speed is important, set to False.</li>
<li><strong>maxuv_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – See <a class="reference internal" href="#galario.double.check_uvplane" title="galario.double.check_uvplane"><code class="xref py py-func docutils literal"><span class="pre">check_uvplane()</span></code></a>.
<strong>units</strong>: pure number</li>
<li><strong>minuv_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – See <a class="reference internal" href="#galario.double.check_uvplane" title="galario.double.check_uvplane"><code class="xref py py-func docutils literal"><span class="pre">check_uvplane()</span></code></a>.
<strong>units</strong>: pure number</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>chi2</strong> – The chi square, not normalized.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#galario.double.sampleProfile" title="galario.double.sampleProfile"><code class="xref py py-func docutils literal"><span class="pre">sampleProfile()</span></code></a>, <a class="reference internal" href="#galario.double.sweep" title="galario.double.sweep"><code class="xref py py-func docutils literal"><span class="pre">sweep()</span></code></a></p>
</div>
</dd></dl>

</div>
<div class="section" id="useful-functions">
<h2>Useful functions<a class="headerlink" href="#useful-functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="galario.double.check_uvplane">
<code class="descclassname">galario.double.</code><code class="descname">check_uvplane</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#galario.double.check_uvplane" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether the setup of the (u, v) plane satisfies Nyquist criteria for (u, v) plane sampling.</p>
<p>Typical call signature:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">check_uvplane</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">nxy</span><span class="p">,</span> <span class="n">duv</span><span class="p">,</span> <span class="n">maxuv_factor</span><span class="p">,</span> <span class="n">minuv_factor</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>u</strong> (<em>array_like</em><em>, </em><em>float</em>) – u coordinate of the visibility points where the FT has to be sampled.
<strong>units</strong>: wavelength</li>
<li><strong>v</strong> (<em>array_like</em><em>, </em><em>float</em>) – v coordinate of the visibility points where the FT has to be sampled.
The length of v must be equal to the length of u.
<strong>units</strong>: wavelength</li>
<li><strong>nxy</strong> (<em>int</em>) – Size of the image along x and y direction.
<strong>units</strong>: pixel</li>
<li><strong>duv</strong> (<em>float</em>) – Size of the cell in the (u, v) plane, assumed uniform and equal on both u and v directions.
<strong>units</strong>: wavelength</li>
<li><strong>maxuv_factor</strong> (<em>float</em>) – Nyquist rate: numerical factor that ensures the Nyquist criterion is satisfied when sampling
the synthetic visibilities at the specified (u, v) locations. Must be larger than 2.
The maximum (u, v)-distance covered is <cite>maxuv_factor</cite> times the maximum (u, v)-distance
of the observed visibilities.
<strong>units</strong>: pure number</li>
<li><strong>minuv_factor</strong> (<em>float</em>) – Size of the field of view covered by the (u, v) plane grid w.r.t. the field
of view covered by the image. Recommended to be larger than 3 for better results.
<strong>units</strong>: pure number</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="galario.double.sweep">
<code class="descclassname">galario.double.</code><code class="descname">sweep</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#galario.double.sweep" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a 2D model image from an axisymmetric brightness profile.</p>
<p>The image is created assuming that the x-axis (R.A.) increases
from right (West) to left (East) and the y-axis (Dec.) increases
from bottom (South) to top (North).</p>
<p>Typical call signature:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">image</span> <span class="o">=</span> <span class="n">sweep</span><span class="p">(</span><span class="n">intensity</span><span class="p">,</span> <span class="n">Rmin</span><span class="p">,</span> <span class="n">dR</span><span class="p">,</span> <span class="n">nxy</span><span class="p">,</span> <span class="n">dxy</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">inc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>intensity</strong> (<em>2D array_like</em><em>, </em><em>float</em>) – Array containing the radial brightness profile of the model.
The brightness profile is assumed to be sampled on a linear radial grid
starting at <cite>Rmin</cite> and with spacing <cite>dR</cite>.
<strong>units</strong>: Jy/sr</li>
<li><strong>Rmin</strong> (<em>float</em>) – Inner edge of the radial grid, i.e. the radius where the brightness is intensity[0].
<strong>units</strong>: cm</li>
<li><strong>dR</strong> (<em>float</em>) – Size of the cell of the radial grid, assumed linear.
<strong>units</strong>: cm</li>
<li><strong>nxy</strong> (<em>int</em>) – Side of the square model image.
<strong>units</strong>: pixel</li>
<li><strong>dxy</strong> (<em>float</em>) – Size of the image cell, assumed equal and uniform in both x and y direction.
<strong>units</strong>: cm</li>
<li><strong>dist</strong> (<em>float</em>) – Distance to the source.
<strong>units</strong>: cm</li>
<li><strong>inc</strong> (<em>float</em><em>, </em><em>optional</em>) – Inclination of the image plane along a North-South (top-bottom) axis.
If inc=0. the image is face-on; if inc=90. the image is edge-on.
<strong>units</strong>: degree</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>image</strong> – Image of the surface brightness.
<strong>units</strong>: Jy/pixel</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(nxy, nxy) array_like, float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
    <a id="sidebar-anchor"></a>
    

  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Python API reference</a><ul>
<li><a class="reference internal" href="#computing-synthetic-visibilities">Computing synthetic visibilities</a></li>
<li><a class="reference internal" href="#computing-directly-the-chi-square">Computing directly the chi square</a></li>
<li><a class="reference internal" href="#useful-functions">Useful functions</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="quickstart.html"
                        title="previous chapter">A quickstart example</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="C-api.html"
                        title="next chapter">Using galario from C</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/py-api.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="C-api.html" title="Using galario from C"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="quickstart.html" title="A quickstart example"
             accesskey="P">previous</a> |</li>
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Marco Tazzari, Frederik Beaujean, Leonardo Testi.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
  </body>
</html>